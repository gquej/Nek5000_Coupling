c     prcvrt: coordinates of the vertices, v1_x,v1_y,v1_z,v2_x,v2_y,v2_z,...
c     prcvid: id of the vertices
c     prcwdt: buffer of data to be written to the other solver
c     prcrdt: buffer of data to be read from the other solver
c     prcdt: time step
c     prcdim: dimension of the problem
c     prcnve: number of vertices
c     mpgprc: mapping between the outer boundary vertices and the unique vertices of the mesh boundary
      real prcvrt (0:200000) !77 
      integer prcvid (0:200000) !25
      real prcwdt (0:400000)
      real prcrdt (0:200000)
      real prcrdx (0:200000)
      real prcrdy (0:200000)
      real prcrdz (0:200000)

      real prcvr2 (0:400000) !77
      integer prcvi2 (0:150000) !25
      character omeshn*11
      integer omshdi 
      real prcbox (0:5)
      real*8 prcdt
      integer prcdim
      integer prcnve
      integer mpgprc (lx1,ly1,lz1,lelv)
      character parnm*100
      character config*100
      character meshnm*100
      character rdDtNm*100 !data name for velocity field from murphy
      character rdDtNa*100 ! data name for vort field from murphy
      character rdDtNb*100
      character rdDtNc*100
      character wrDtNm*100

      ! trying to fix the problem of duplicate murphy vertices across ranks
      real buf_loc(0:80000)
      real buf_glob(0:960000)
      integer buf_count(0:0)
      integer buf_count_glob(0:12)
      integer keep_u(0:80000),keep_v(0:80000),keep_w(0:80000)
      common /precic/ buf_loc, buf_glob,buf_count,buf_count_glob
      common /precic/ keep_u,keep_v,keep_w

      real usol(lx1,lx1,6,lelt) ! u field on the boundary nodes of each element
      !stored face by face with the numbering 4,2,1,3,5,6 for x-,x+,y-,y+,z-,z+
      real vsol(lx1,lx1,6,lelt) ! v field on the boundary nodes of each element
      real wsol(lx1,lx1,6,lelt) ! w field on the boundary nodes of each element
      integer tmpl1(2*ldim,lelt), tmpl2(2*ldim,lelt)
      integer tmpl3(2*ldim,lelt), tmpl4(2*ldim,lelt)
      integer l_fbc(lelt), l_fnbc(lelt)
      real x_corner(8),y_corner(8),z_corner(8)

      !arrays for interpolation of u, v, w
      integer handle_u, handle_v, handle_w
      integer rcodeu(0:130000), rcodev(0:130000),rcodew(0:130000)
      integer procu(0:130000), procv(0:130000),procw(0:130000)
      integer elidu(0:130000), elidv(0:130000),elidw(0:130000)
      real rstu(0:400000),rstvv(0:400000),rstw(0:400000)  !rstvv because rstv is already used...
      real distu(0:400000), distv(0:400000), distw(0:400000) 

      !try to stabilize the coupling: store the values of interior point at previous time step
      !since we treat the thing by element, and by face, thats basically a lot of additional data...
      


      common /precic/ handle_u, handle_v, handle_w
      common /precic/ rcodeu, rcodev, rcodew
      common /precic/ procu, procv, procw
      common /precic/ elidu, elidv, elidw
      common /precic/ rstu, rstvv, rstw 
      common /precic/ distu, distv, distw


      common /pernw/ tmpl1,tmpl2,tmpl3,tmpl4,l_fbc,l_fnbc
      common /pernw/ x_corner, y_corner, z_corner
      common /pernw/ usol, vsol, wsol

      common /precic/ prcvrt, mpgprc, prcnve, prcwdt, prcrdt
      common /precic/ prcdt, parnm, config, meshnm, rdDtNm, wrDtNm
      common /precic/ rdDtNa, rdDtNb, rdDtNc
      common /precic/ prcrdx, prcrdy, prcrdz
      common /precic/ prcdim
      common /precic/ prcvid

      common /precic/ prcvr2, prcvi2, omeshn, prcbox, omshdi
    